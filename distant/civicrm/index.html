<!doctype html><html lang=fr class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.120.4"><meta name=description content="Documentation du module SPIP Campagnodon et de son écosystème"><meta name=author content="John Livingston"><link rel=icon href=/campagnodon/images/favicon.png type=image/png><title>CiviCRM :: Documentation Campagnodon</title>
<link href=/campagnodon/css/nucleus.css?1701773211 rel=stylesheet><link href=/campagnodon/css/fontawesome-all.min.css?1701773211 rel=stylesheet><link href=/campagnodon/css/hybrid.css?1701773211 rel=stylesheet><link href=/campagnodon/css/featherlight.min.css?1701773211 rel=stylesheet><link href=/campagnodon/css/perfect-scrollbar.min.css?1701773211 rel=stylesheet><link href=/campagnodon/css/auto-complete.css?1701773211 rel=stylesheet><link href=/campagnodon/css/atom-one-dark-reasonable.css?1701773211 rel=stylesheet><link href=/campagnodon/css/theme.css?1701773211 rel=stylesheet><link href=/campagnodon/css/tabs.css?1701773211 rel=stylesheet><link href=/campagnodon/css/hugo-theme.css?1701773211 rel=stylesheet><link href=/campagnodon/css/theme-red.css?1701773211 rel=stylesheet><script src=/campagnodon/js/jquery-3.3.1.min.js?1701773211></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/campagnodon/distant/civicrm/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://johnxlivingston.github.io/campagnodon><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="32" height="32" viewBox="0 0 8.4666665 8.4666669" id="svg8" inkscape:version="1.0.2 (e86c870879, 2021-01-15)" sodipodi:docname="campagnodon.svg" inkscape:export-xdpi="96" inkscape:export-ydpi="96"><defs id="defs2"/><sodipodi:namedview id="base" pagecolor="#0000ff" bordercolor="#666666" borderopacity="1" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:zoom="11.313708" inkscape:cx="15.039202" inkscape:cy="22.757451" inkscape:document-units="px" inkscape:current-layer="svg8" inkscape:document-rotation="0" showgrid="false" units="px" inkscape:pagecheckerboard="false" inkscape:window-width="1851" inkscape:window-height="1016" inkscape:window-x="0" inkscape:window-y="1077" inkscape:window-maximized="1"/><rect style="opacity:.998;fill:#000;stroke:#e50000;stroke-width:.480546;stroke-opacity:1" id="rect919" width="5.9668069" height=".97400463" x="-1.3223097" y="6.4409332" ry=".48700231" transform="rotate(-22.990066)"/><g inkscape:label="Calque 1" inkscape:groupmode="layer" id="layer1"><ellipse style="fill:#fff;fill-opacity:1;stroke:#fff;stroke-width:.478532;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="path1426" cx="2.8814063" cy="2.7711506" rx=".75977445" ry=".72326106"/><ellipse style="fill:#fff;fill-opacity:1;stroke:#fff;stroke-width:.409628;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="path1426-3" cx="4.4484239" cy="4.827558" rx=".65037453" ry=".61911869"/></g></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Rechercher...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/campagnodon/js/lunr.min.js?1701773211></script><script type=text/javascript src=/campagnodon/js/auto-complete.js?1701773211></script><script type=text/javascript>var baseurl="https://johnxlivingston.github.io/campagnodon"</script><script type=text/javascript src=/campagnodon/js/search.js?1701773211></script></div><div class=highlightable><ul class=topics><li data-nav-id=/campagnodon/presentation/ title=Présentation class=dd-item><a href=/campagnodon/presentation/>Présentation
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/campagnodon/presentation/fonctionnel/ title=Fonctionnel class=dd-item><a href=/campagnodon/presentation/fonctionnel/>Fonctionnel
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/campagnodon/presentation/architecture/ title=Architecture class=dd-item><a href=/campagnodon/presentation/architecture/>Architecture
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/campagnodon/presentation/licence/ title=Licence class=dd-item><a href=/campagnodon/presentation/licence/>Licence
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/campagnodon/distant/ title="Systèmes distants" class="dd-item
parent"><a href=/campagnodon/distant/>Systèmes distants
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/campagnodon/distant/civicrm/ title=CiviCRM class="dd-item
active"><a href=/campagnodon/distant/civicrm/>CiviCRM
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/campagnodon/fonctionnel/ title="Documentation fonctionnelle" class=dd-item><a href=/campagnodon/fonctionnel/>Documentation fonctionnelle
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/campagnodon/fonctionnel/campagnes/ title=Campagnes class=dd-item><a href=/campagnodon/fonctionnel/campagnes/>Campagnes
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/campagnodon/fonctionnel/articles/ title="Utilisation dans un article" class=dd-item><a href=/campagnodon/fonctionnel/articles/>Utilisation dans un article
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/campagnodon/fonctionnel/formulaires/ title="Faire un don ou adhérer" class=dd-item><a href=/campagnodon/fonctionnel/formulaires/>Faire un don ou adhérer
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/campagnodon/technique/ title="Documentation technique" class=dd-item><a href=/campagnodon/technique/>Documentation technique
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/campagnodon/limitations/ title="Limitations connues" class=dd-item><a href=/campagnodon/limitations/>Limitations connues
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/campagnodon/glossaire/ title=Glossaire class=dd-item><a href=/campagnodon/glossaire/>Glossaire
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>Aller plus loin</h3><ul><li><a class=padding href=https://code.globenet.org/attacfr/campagnodon><i class='fab fa-git'></i> Dépot Globenet</a></li><li><a class=padding href=https://github.com/JohnXLivingston/campagnodon><i class='fab fa-github'></i> Dépot Github</a></li><li><a class=padding href=https://liberapay.com/JohnLivingston><i></i> Soutenir l'auteur</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Supprimer l'historique</a></li></ul></section><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/campagnodon/>Campagnodon</a> > <a href=/campagnodon/distant/>Systèmes distants</a> > CiviCRM</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#installation-de-civicrm>Installation de CiviCRM</a><ul><li><a href=#buildkit>buildkit</a></li><li><a href=#déployer-une-instance-civicrm>Déployer une instance CiviCRM</a></li><li><a href=#configurations-spécifiques-de-civicrm>Configurations spécifiques de CiviCRM</a></li><li><a href=#installer-lextension-civicrm-campagnodon>Installer l&rsquo;extension CiviCRM Campagnodon</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>CiviCRM</h1><p>Le présent document indique comment installer un environnement de développement/test conforme à ce qu&rsquo;utilise Attac.</p><h2 id=installation-de-civicrm>Installation de CiviCRM</h2><p><a href=https://civicrm.org/>CiviCRM</a></p><h3 id=buildkit>buildkit</h3><p>CiviCRM fourni l&rsquo;outils <a href=https://docs.civicrm.org/dev/en/latest/tools/buildkit/>buildkit</a> qui met à disposition un ensemble d&rsquo;outils pour faciliter le déploiement d&rsquo;instances CiviCRM sur une machine de développement.</p><p>La première étape est donc d&rsquo;installer buildkit sur la machine de développement (ou dans une machine virtuelle).</p><p>Pour cela, suivre la documentation d&rsquo;installation de <a href=https://docs.civicrm.org/dev/en/latest/tools/buildkit/#installation>buildkit</a>.</p><h3 id=déployer-une-instance-civicrm>Déployer une instance CiviCRM</h3><p>CiviCRM doit être associé à un CRM. Chez Attac, il s&rsquo;agit de Drupal 7.
À l&rsquo;heure où cette documentation est écrite, CiviCRM est dans la version 5.47.</p><p>On peut aisément utiliser l&rsquo;utilitaire <a href=https://docs.civicrm.org/dev/en/latest/tools/civibuild/>civibuild</a> pour créer une instance CiviCRM vierge. Pour cela, se placer dans le dossier où l&rsquo;on a intallé buildkit, puis:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./bin/civibuild create dev_attac --type drupal-clean --url http://127.0.0.1:9900 --civi-ver  5.47
</span></span></code></pre></div><p>Dans la ligne ci-dessus, on choisi d&rsquo;installer CiviCRM sur localhost, et le rendre accessible via le port 9900.
Adaptez ceci à votre situation.</p><p>Les identifiants pour s&rsquo;y connecter seront affiché dans la console.</p><p>Note: ce type d&rsquo;installation vient avec des données d&rsquo;exemple.</p><h3 id=configurations-spécifiques-de-civicrm>Configurations spécifiques de CiviCRM</h3><p>Le mode de fonctionnement pour Attac suppose les configurations ci-dessous.</p><ol><li>Activer le composant «civicampaign» (<code>Administrer > Paramètres système > Composants</code>).</li><li>Il faut activer l&rsquo;extension php-curl sur le serveur qui fait tourner le système d&rsquo;origine (SPIP).</li><li>Il est possible d&rsquo;utiliser le composant «CiviRules» pour envoyer des mails.</li></ol><h3 id=installer-lextension-civicrm-campagnodon>Installer l&rsquo;extension CiviCRM Campagnodon</h3><p>Allant de paire avec Campagnodon, il y a une Extension CiviCRM <a href=https://code.globenet.org/attacfr/campagnodon-civicrm>campagnodon-civicrm</a>.</p><p>Placer les fichiers de l&rsquo;extension dans le dossier des extensions du CiviCRM, puis aller dans l&rsquo;interface d&rsquo;administration <code>Administrer > Paramètres système > Extension</code> pour l&rsquo;activer.</p><p>Il faut ensuite obtenir des clés d&rsquo;API CiviCRM, et les configurer coté SPIP.
Pour obtenir les clés, on pourra par exemple installer l&rsquo;extension <code>API Key Management</code>.
Ensuite, aller sur la fiche contact de l&rsquo;utilisateur admin qui servira (ce sont ses droits qui seront appliqués), ouvrir l&rsquo;onglet «API Key», générer une nouvelle clé d&rsquo;API. La clé de site, aussi nécessaire, est affichée sur le même écran.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/campagnodon/distant/ title="Systèmes distants"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/campagnodon/fonctionnel/ title="Documentation fonctionnelle" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/campagnodon/js/clipboard.min.js?1701773211></script><script src=/campagnodon/js/perfect-scrollbar.min.js?1701773211></script><script src=/campagnodon/js/perfect-scrollbar.jquery.min.js?1701773211></script><script src=/campagnodon/js/jquery.sticky.js?1701773211></script><script src=/campagnodon/js/featherlight.min.js?1701773211></script><script src=/campagnodon/js/highlight.pack.js?1701773211></script><script>hljs.initHighlightingOnLoad()</script><script src=/campagnodon/js/modernizr.custom-3.6.0.js?1701773211></script><script src=/campagnodon/js/learn.js?1701773211></script><script src=/campagnodon/js/hugo-learn.js?1701773211></script><script src=/campagnodon/mermaid/mermaid.js?1701773211></script><script>mermaid.initialize({startOnLoad:!0})</script></body></html>